{"ast":null,"code":"import _regeneratorRuntime from\"/Users/daniellifshitz/Documents/GitHub/WhatsappDesign/reactclient/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/daniellifshitz/Documents/GitHub/WhatsappDesign/reactclient/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/daniellifshitz/Documents/GitHub/WhatsappDesign/reactclient/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'../login_signup.css';import{Link,useNavigate}from'react-router-dom';import Form from\"react-bootstrap/Form\";import Button from\"react-bootstrap/Button\";import{useState}from\"react\";import{name_picture}from'../../chat/Chat';import{socket}from\"../../App\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var token;function Login(_ref){var setLoggedIn=_ref.setLoggedIn;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var navigate=useNavigate();function checkForUser(_x){return _checkForUser.apply(this,arguments);}function _checkForUser(){_checkForUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var username,password,data,res,text,res2,json2;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();username=event.target.username.value;password=event.target.password.value;data={username:username,password:password};// check if user exists - if it exists, get the token.\n_context.next=6;return fetch('http://localhost:5000/api/Tokens',{'method':'post','headers':{'Content-Type':'application/json'// 'accept': 'application/json',\n},'body':JSON.stringify(data)});case 6:res=_context.sent;_context.next=9;return res.text();case 9:text=_context.sent;if(!(res.status===200)){_context.next=26;break;}//OK - user exists\ntoken=text;// get user info.\n_context.next=14;return fetch('http://localhost:5000/api/Users/'+username,{'method':'get','headers':{'Content-Type':'application/json','authorization':\"bearer \"+token}});case 14:res2=_context.sent;_context.next=17;return res2.json();case 17:json2=_context.sent;name_picture.displayname=json2.displayName;name_picture.profilePicture=json2.profilePic;name_picture.userName=json2.username;//go to chat, and set error to false (no error).\nsetError(false);setLoggedIn(true);navigate('/chat',{replace:true});socket.emit(\"logged_in\",{socket:socket.id,username:json2.username});return _context.abrupt(\"return\");case 26:// if(username in users) {\n//     if( users[username].password === password){\n//         name_picture.displayname = users[username].displayname;\n//         name_picture.profilePicture = users[username].pfp;\n//         setError(false);\n//         setLoggedIn(true);\n//         navigate('/chat',{replace:true});\n//         return;\n//     }\n// }\nsetError(true);case 27:case\"end\":return _context.stop();}},_callee);}));return _checkForUser.apply(this,arguments);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"title\",{children:\"Login\"}),/*#__PURE__*/_jsx(\"link\",{href:\"../login_signup.css\",rel:\"stylesheet\"}),/*#__PURE__*/_jsx(\"div\",{className:\"back-box\"}),/*#__PURE__*/_jsx(\"div\",{className:\"card login-box\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card-body\",children:/*#__PURE__*/_jsxs(Form,{className:\"\",onSubmit:checkForUser,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{htmlFor:\"InputUsername1\",children:\"Username\"}),/*#__PURE__*/_jsxs(Form.Group,{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"input-group-text\",children:\"@\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",className:\"form-control\",id:\"InputUsername1\",placeholder:\"Enter Username\",name:\"username\"})]})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{htmlFor:\"InputPassword1\",children:\"Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",className:\"form-control\",id:\"InputPassword1\",placeholder:\"Enter password\",name:\"password\"})]}),/*#__PURE__*/_jsx(Button,{type:\"submit\",className:\"btn btn-primary\",children:\"Login\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"text-danger\",children:\"Username or password is incorrect.\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"sign-box\",children:[\"Not registered? \",/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"Sign up here\"})]})]})})})]});}export default Login;","map":{"version":3,"names":["Link","useNavigate","Form","Button","useState","name_picture","socket","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","token","Login","_ref","setLoggedIn","_useState","_useState2","_slicedToArray","error","setError","navigate","checkForUser","_x","_checkForUser","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","event","username","password","data","res","text","res2","json2","wrap","_callee$","_context","prev","next","preventDefault","target","value","fetch","JSON","stringify","sent","status","json","displayname","displayName","profilePicture","profilePic","userName","replace","emit","id","abrupt","stop","children","href","rel","className","onSubmit","Group","Label","htmlFor","Control","type","placeholder","name","to"],"sources":["/Users/daniellifshitz/Documents/GitHub/WhatsappDesign/reactclient/src/login_signup/login/Login.js"],"sourcesContent":["import '../login_signup.css';\nimport {Link, useNavigate} from 'react-router-dom'\nimport Form from \"react-bootstrap/Form\";\nimport Button from \"react-bootstrap/Button\"\nimport {useState} from \"react\";\n\n\nimport {name_picture} from '../../chat/Chat'\nimport {socket} from \"../../App\";\n\nexport var token;\nfunction Login({setLoggedIn}) {\n    const [error,setError] = useState(false)\n    const navigate = useNavigate();\n    async function checkForUser(event) {\n        event.preventDefault();\n        const username = event.target.username.value;\n        const password = event.target.password.value;\n        const data = {\n            username:username,\n            password:password\n        }\n\n        // check if user exists - if it exists, get the token.\n        const res = await fetch('http://localhost:5000/api/Tokens', {\n            'method' : 'post',\n            'headers' : {\n                'Content-Type': 'application/json',\n                // 'accept': 'application/json',\n            },\n            'body' : JSON.stringify(data)\n        });\n        const text = await res.text();\n        if(res.status===200) { //OK - user exists\n            token = text;\n            // get user info.\n            const res2 = await fetch('http://localhost:5000/api/Users/'+username, {\n                'method':'get',\n                'headers' : {\n                    'Content-Type': 'application/json',\n                    'authorization' : \"bearer \" + token,\n                }\n            });\n            const json2 = await res2.json();\n            name_picture.displayname = json2.displayName;\n            name_picture.profilePicture = json2.profilePic;\n            name_picture.userName = json2.username;\n            //go to chat, and set error to false (no error).\n            setError(false);\n            setLoggedIn(true);\n            navigate('/chat',{replace:true});\n            socket.emit(\"logged_in\", {socket: socket.id, username: json2.username});\n            return;\n        }\n        // if(username in users) {\n        //     if( users[username].password === password){\n        //         name_picture.displayname = users[username].displayname;\n        //         name_picture.profilePicture = users[username].pfp;\n        //         setError(false);\n        //         setLoggedIn(true);\n        //         navigate('/chat',{replace:true});\n        //         return;\n        //     }\n        // }\n\n        setError(true);\n\n    }\n    return (\n        <>\n            <title>Login</title>\n            <link href=\"../login_signup.css\" rel=\"stylesheet\"/>\n            <div className=\"back-box\"/>\n            <div className=\"card login-box\">\n                <div className=\"card-body\">\n                    <Form className=\"\" onSubmit={checkForUser}>\n                        <Form.Group className=\"mb-3\">\n                            <Form.Label htmlFor=\"InputUsername1\">Username</Form.Label>\n                            <Form.Group className=\"input-group\">\n                                <div className=\"input-group-text\">@</div>\n                                <Form.Control\n                                    type=\"text\"\n                                    className=\"form-control\"\n                                    id=\"InputUsername1\"\n                                    placeholder=\"Enter Username\"\n                                    name='username'\n                                />\n                            </Form.Group>\n                        </Form.Group>\n                        <Form.Group className=\"mb-3\">\n                            <Form.Label htmlFor=\"InputPassword1\">Password</Form.Label>\n                            <Form.Control\n                                type=\"password\"\n                                className=\"form-control\"\n                                id=\"InputPassword1\"\n                                placeholder=\"Enter password\"\n                                name='password'\n                            />\n                        </Form.Group>\n                        <Button type=\"submit\" className=\"btn btn-primary\">\n                            Login\n                        </Button>\n                        {error && (\n                            <div className='text-danger'>\n                                Username or password is incorrect.\n                            </div>\n                        )}\n                        <span className=\"sign-box\">\n          Not registered? <Link to=\"/\">Sign up here</Link>\n        </span>\n                    </Form>\n                </div>\n            </div>\n        </>\n\n    );\n}\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}